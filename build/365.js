"use strict";(globalThis.webpackChunkultimate_spin_wheel=globalThis.webpackChunkultimate_spin_wheel||[]).push([[365],{365:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var r=a(609),s=a(723),n=a(143),l=a(582);const o=()=>{const[e,t]=(0,r.useState)(""),[a,o]=(0,r.useState)({}),i=(0,n.useSelect)(e=>{const{getSite:t}=e(l.store),a=t();return a?.url||""},[]),{campaigns:c,loading:d,error:m}=(0,n.useSelect)(e=>{const{getEntityRecords:t,isResolving:a,getLastEntitySaveError:r}=e(l.store);return{campaigns:t("postType","wowdevs_engage",{per_page:-1}),loading:a("getEntityRecords",["postType","wowdevs_engage",{per_page:-1}]),error:r&&r("postType","wowdevs_engage")}},[]),g=c?c.map(e=>a[e.id]||e):c,u=e=>{let t=new URL(window.location.href);return t.searchParams.set("post_id",e),t.hash="config",t.toString()};return(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 p-6 rounded-xl shadow-sm mb-8"},(0,r.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,r.createElement)("h2",{className:"text-3xl font-bold text-gray-800 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"},(0,s.__)("Campaigns","ultimate-spin-wheel"))),(0,r.createElement)("form",{className:"mb-4 flex gap-4",onSubmit:a=>{a.preventDefault(),(async()=>{if(e.trim())try{const{saveEntityRecord:a}=(0,n.dispatch)(l.store),r=await a("postType","wowdevs_engage",{title:e,status:"publish",meta:{uspw_type:"spin_wheel",uspw_status:"disabled",uspw_start_date:(new Date).toISOString(),uspw_end_date:new Date(Date.now()+5184e6).toISOString()}});console.log("Campaign created successfully:",r),t("")}catch(e){console.error("Error creating campaign:",e),console.error("Error details:",{message:e.message,code:e.code,data:e.data}),alert((0,s.__)("Failed to create campaign. Please check console for details.","ultimate-spin-wheel"))}else alert((0,s.__)("Please enter a campaign name.","ultimate-spin-wheel"))})()}},(0,r.createElement)("div",{className:"flex-1 max-w-md"},(0,r.createElement)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:(0,s.__)("Enter campaign name","ultimate-spin-wheel"),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition-all duration-200 bg-white shadow-sm",required:!0})),(0,r.createElement)("button",{type:"submit",className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-8 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 flex items-center gap-2"},(0,r.createElement)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})),(0,s.__)("Create Campaign","ultimate-spin-wheel")))),(0,r.createElement)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden"},d?(0,r.createElement)("div",{className:"p-12 text-center"},(0,r.createElement)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.createElement)("p",{className:"mt-4 text-gray-600"},"Loading campaigns...")):m?(0,r.createElement)("div",{className:"p-8 text-center"},(0,r.createElement)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6"},(0,r.createElement)("svg",{className:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})),(0,r.createElement)("p",{className:"text-red-600 font-medium"},m.message||"Error loading campaigns."))):(0,r.createElement)("div",{className:"overflow-x-auto"},(0,r.createElement)("table",{className:"w-full dark:bg-gray-800 dark:text-gray-200"},(0,r.createElement)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 border-b border-gray-200 dark:border-gray-700"},(0,r.createElement)("tr",null,(0,r.createElement)("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider"},"Campaign Name"),(0,r.createElement)("th",{scope:"col",className:"px-3 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider"},"Status"),(0,r.createElement)("th",{scope:"col",className:"px-3 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider"},"Schedule At"),(0,r.createElement)("th",{scope:"col",className:"px-3 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider"},"Reports"),(0,r.createElement)("th",{scope:"col",className:"px-3 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider"},"-"))),(0,r.createElement)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700"},g&&g.length>0?g.map((e,t)=>(0,r.createElement)("tr",{key:e.id,className:"hover:bg-gray-100 dark:hover:bg-gray-700"},(0,r.createElement)("td",{className:"pl-6 py-4"},(0,r.createElement)("div",{className:"font-semibold text-gray-900 text-sm"},e.title?.rendered||e.title,(0,r.createElement)("small",{className:"text-gray-500 ml-1 text-xs",title:"Campaign ID"},"(ID#",e?.id,")"),(0,r.createElement)("small",{className:"text-gray-500 mt-1 block"},"Date: ",e?.date_gmt?new Date(e.date_gmt).toLocaleString():"-"))),(0,r.createElement)("td",{className:"px-2 py-4"},(0,r.createElement)("div",{className:"flex items-center gap-3"},(0,r.createElement)("button",{onClick:()=>(async e=>{const t="enabled"===e.meta?.uspw_status?"enabled":"disabled",a="enabled"===t?"disabled":"enabled";console.log("Toggling campaign status:",{campaignId:e.id,currentStatus:t,newStatus:a,currentMeta:e.meta}),o(t=>({...t,[e.id]:{...e,meta:{...e.meta,uspw_status:a}}}));try{const{editEntityRecord:t,saveEditedEntityRecord:r}=(0,n.dispatch)(l.store);await t("postType","wowdevs_engage",e.id,{meta:{...e.meta,uspw_status:a}});const s=await r("postType","wowdevs_engage",e.id);console.log("Campaign status updated successfully:",s),o(t=>{const a={...t};return delete a[e.id],a})}catch(t){console.error("Error updating campaign status:",t),console.error("Error details:",{message:t.message,code:t.code,data:t.data}),o(t=>{const a={...t};return delete a[e.id],a}),alert((0,s.__)("Failed to update campaign status. Please check console for details.","ultimate-spin-wheel"))}})(e),disabled:a[e.id],className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-75 ${"enabled"===e.meta?.uspw_status?"bg-green-500 hover:bg-green-600 shadow-green-200":"bg-gray-300 hover:bg-gray-400 shadow-gray-200"} shadow-lg`},(0,r.createElement)("span",{className:"sr-only"},"Toggle status"),(0,r.createElement)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-all duration-300 ease-in-out shadow-sm "+("enabled"===e.meta?.uspw_status?"translate-x-6 shadow-md":"translate-x-1 shadow-sm")}),a[e.id]&&(0,r.createElement)("div",{className:"absolute inset-0 flex items-center justify-center"},(0,r.createElement)("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}))),(0,r.createElement)("span",{className:"text-sm font-medium transition-colors duration-200 "+("enabled"===e.meta?.uspw_status?"text-green-600":"text-gray-500")},"enabled"===e.meta?.uspw_status?"Enabled":"Disabled"))),(0,r.createElement)("td",{className:"px-2 py-4 text-gray-600"},e.meta?.uspw_start_date&&(0,r.createElement)("small",{className:"text-gray-500 mt-1 block text-sm"},(0,r.createElement)("strong",{className:"mr-2 font-bold text-xs"},"Start At:"),e.meta?.uspw_start_date?new Date(e.meta.uspw_start_date).toLocaleString():"-"),e.meta?.uspw_end_date&&(0,r.createElement)("small",{className:"text-gray-500 mt-1 block text-sm"},(0,r.createElement)("strong",{className:"mr-2 font-bold text-xs"},"End At:"),e.meta?.uspw_end_date?new Date(e.meta.uspw_end_date).toLocaleString():"-")),(0,r.createElement)("td",{className:"px-2 py-4 text-sm text-gray-600"},(0,r.createElement)("small",{className:"text-gray-500 mt-1 block"},"Coming soon")),(0,r.createElement)("td",{className:"px-2 py-4 flex items-center gap-2"},i&&(0,r.createElement)("a",{href:i+`?spin_wheel=preview&campaign_id=${e.id}&_wpnonce=${USPIN_CONFIG_ADMIN.nonce}`,target:"_blank",title:"Live Preview & Debug",className:"text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800"},(0,r.createElement)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"}))),(0,r.createElement)("a",{href:u(e.id),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},(0,r.createElement)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}))),"spin_wheel"===e.meta?.uspw_type&&(0,r.createElement)("button",{type:"button",className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800",onClick:()=>(async e=>{if(window.confirm((0,s.__)("Are you sure you want to delete this campaign?","ultimate-spin-wheel")))try{const{deleteEntityRecord:t}=(0,n.dispatch)(l.store);await t("postType","wowdevs_engage",e)}catch(e){console.error("Error deleting campaign:",e),alert((0,s.__)("Failed to delete campaign. Please try again.","ultimate-spin-wheel"))}})(e.id)},(0,r.createElement)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})))))):(0,r.createElement)("tr",null,(0,r.createElement)("td",{colSpan:"7",className:"text-center py-4"},(0,r.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},(0,r.createElement)("p",{className:"text-lg font-medium"},"No campaigns found"),(0,r.createElement)("p",{className:"text-sm mt-1"},"Create your first campaign to get started")))))))))}}}]);